import { expectTypeOf } from 'vitest';
import { assert, assertIsNonNullish, assertIsNullish } from './assertions';

describe('assert', () => {
  test('throws on false condition and narrows type', () => {
    expect(() => {
      ((x: number | string) => {
        assert(x === 5);
        expectTypeOf(x).toEqualTypeOf<number>;
      })('abc');
    }).toThrow();
  });
});

describe('assertIsNullish', () => {
  test('throws if non-nullish and narrows type', () => {
    expect(() => {
      ((x: null | undefined | string) => {
        assertIsNullish(x);
        expectTypeOf(x).toEqualTypeOf<null | undefined>;
      })('abc');
    }).toThrow();
  });
});